
#include "leddriver.h"
#include "ledstask.h"

#define LEDS_NUM_TATAL 13 



const unsigned char leds_buf_1[10][10]=
{
    1,0,0,0,0,0,0,0,0,0,
    0,1,0,0,0,0,0,0,0,0,
    0,0,1,0,0,0,0,0,0,0,
    0,0,0,1,0,0,0,0,0,0,
    0,0,0,0,1,0,0,0,0,0,
    0,0,0,0,0,1,0,0,0,0,
    0,0,0,0,0,0,1,0,0,0,
    0,0,0,0,0,0,0,1,0,0,
    0,0,0,0,0,0,0,0,1,0,
    0,0,0,0,0,0,0,0,0,1,
    
};
const unsigned char leds_buf_2[10][10]=
{
    2,0,0,0,0,0,0,0,0,0,
    0,2,0,0,0,0,0,0,0,0,
    0,0,2,0,0,0,0,0,0,0,
    0,0,0,2,0,0,0,0,0,0,
    0,0,0,0,2,0,0,0,0,0,
    0,0,0,0,0,2,0,0,0,0,
    0,0,0,0,0,0,2,0,0,0,
    0,0,0,0,0,0,0,2,0,0,
    0,0,0,0,0,0,0,0,2,0,
    0,0,0,0,0,0,0,0,0,2,
    
};
const unsigned char leds_buf_3[10][10]=
{
    1,0,0,0,0,0,0,0,0,0,
    1,1,0,0,0,0,0,0,0,0,
    1,1,1,0,0,0,0,0,0,0,
    1,1,1,1,0,0,0,0,0,0,
    1,1,1,1,1,0,0,0,0,0,
    1,1,1,1,1,1,0,0,0,0,
    1,1,1,1,1,1,1,0,0,0,
    1,1,1,1,1,1,1,1,0,0,
    1,1,1,1,1,1,1,1,1,0,
    1,1,1,1,1,1,1,1,1,1,
    
};
const unsigned char leds_buf_4[10][10]=
{
    2,0,0,0,0,0,0,0,0,0,
    2,2,0,0,0,0,0,0,0,0,
    2,2,2,0,0,0,0,0,0,0,
    2,2,2,2,0,0,0,0,0,0,
    2,2,2,2,2,0,0,0,0,0,
    2,2,2,2,2,2,0,0,0,0,
    2,2,2,2,2,2,2,0,0,0,
    2,2,2,2,2,2,2,2,0,0,
    2,2,2,2,2,2,2,2,2,0,
    2,2,2,2,2,2,2,2,2,2,
    
};
const unsigned char leds_buf_5[10][12]=
{
    2,2,2,2,2,2,2,2,2,2,
    1,1,1,1,1,1,1,1,1,1,
    0,0,0,0,0,0,0,0,0,0,
    2,2,2,2,2,2,2,2,2,2,
    1,1,1,1,1,1,1,1,1,1,
    0,0,0,0,0,0,0,0,0,0,
    2,2,2,2,2,2,2,2,2,2,
    1,1,1,1,1,1,1,1,1,1,
    0,0,0,0,0,0,0,0,0,0,
    2,2,2,2,2,2,2,2,2,2,
    1,1,1,1,1,1,1,1,1,1,
    0,0,0,0,0,0,0,0,0,0,
    
};

const unsigned char leds_buf_6[10][12]=
{
    1,0,1,0,1,0,1,0,1,0,
    2,0,2,0,2,0,2,0,2,0,
    0,1,0,1,0,1,0,1,0,1,
    0,2,0,2,0,2,0,2,0,2,
    1,0,1,0,1,0,1,0,1,0,
    2,0,2,0,2,0,2,0,2,0,
    0,1,0,1,0,1,0,1,0,1,
    0,2,0,2,0,2,0,2,0,2,
    1,0,1,0,1,0,1,0,1,0,
    2,0,2,0,2,0,2,0,2,0,
    0,1,0,1,0,1,0,1,0,1,
    0,2,0,2,0,2,0,2,0,2,
    
};
const unsigned char leds_buf_7[10][12]=
{
    0,1,0,1,0,1,0,1,0,1,
    0,2,0,2,0,2,0,2,0,2,
    1,0,1,0,1,0,1,0,1,0,
    2,0,2,0,2,0,2,0,2,0,
    0,1,0,1,0,1,0,1,0,1,
    0,2,0,2,0,2,0,2,0,2,
    1,0,1,0,1,0,1,0,1,0,
    2,0,2,0,2,0,2,0,2,0,
    0,1,0,1,0,1,0,1,0,1,
    0,2,0,2,0,2,0,2,0,2,
    1,0,1,0,1,0,1,0,1,0,
    2,0,2,0,2,0,2,0,2,0,
    
};
const unsigned char leds_buf_8[10][12]=
{
    2,2,2,2,2,2,2,2,2,2,
    1,1,1,1,1,1,1,1,1,1,
    0,0,0,0,0,0,0,0,0,0,
    2,2,2,2,2,2,2,2,2,2,
    1,1,1,1,1,1,1,1,1,1,
    0,0,0,0,0,0,0,0,0,0,
    2,2,2,2,2,2,2,2,2,2,
    1,1,1,1,1,1,1,1,1,1,
    0,0,0,0,0,0,0,0,0,0,
    2,2,2,2,2,2,2,2,2,2,
    1,1,1,1,1,1,1,1,1,1,
    0,0,0,0,0,0,0,0,0,0,
    
};


const unsigned char leds_buf_9[10][10]=
{
    0,1,1,1,1,1,1,1,1,1,
    1,0,1,1,1,1,1,1,1,1,
    1,1,0,1,1,1,1,1,1,1,
    1,1,1,0,1,1,1,1,1,1,
    1,1,1,1,0,1,1,1,1,1,
    1,1,1,1,1,0,1,1,1,1,
    1,1,1,1,1,1,0,1,1,1,
    1,1,1,1,1,1,1,0,1,1,
    1,1,1,1,1,1,1,1,0,1,
    1,1,1,1,1,1,1,1,1,0,
    
};
const unsigned char leds_buf_10[10][10]=
{
    0,2,2,2,2,2,2,2,2,2,
    2,0,2,2,2,2,2,2,2,2,
    2,2,0,2,2,2,2,2,2,2,
    2,2,2,0,2,2,2,2,2,2,
    2,2,2,2,0,2,2,2,2,2,
    2,2,2,2,2,0,2,2,2,2,
    2,2,2,2,2,2,0,2,2,2,
    2,2,2,2,2,2,2,0,2,2,
    2,2,2,2,2,2,2,2,0,2,
    2,2,2,2,2,2,2,2,2,0,
    
};

const unsigned char leds_buf_11[10][11]=
{  
    1,1,1,1,1,1,1,1,1,1,  
    0,1,1,1,1,1,1,1,1,1, 
    0,0,1,1,1,1,1,1,1,1, 
    0,0,0,1,1,1,1,1,1,1, 
    0,0,0,0,1,1,1,1,1,1, 
    0,0,0,0,0,1,1,1,1,1, 
    0,0,0,0,0,0,1,1,1,1, 
    0,0,0,0,0,0,0,1,1,1, 
    0,0,0,0,0,0,0,0,1,1, 
    0,0,0,0,0,0,0,0,0,1, 
    0,0,0,0,0,0,0,0,0,0,
   
};
const unsigned char leds_buf_12[10][11]=
{  
    2,2,2,2,2,2,2,2,2,2,  
    0,2,2,2,2,2,2,2,2,2, 
    0,0,2,2,2,2,2,2,2,2, 
    0,0,0,2,2,2,2,2,2,2, 
    0,0,0,0,2,2,2,2,2,2, 
    0,0,0,0,0,2,2,2,2,2, 
    0,0,0,0,0,0,2,2,2,2, 
    0,0,0,0,0,0,0,2,2,2, 
    0,0,0,0,0,0,0,0,2,2, 
    0,0,0,0,0,0,0,0,0,2, 
    0,0,0,0,0,0,0,0,0,0,
   
};
const unsigned char leds_buf_13[10][100]=
{  
    1,0,0,0,0,0,0,0,0,0,
    0,1,0,0,0,0,0,0,0,0,
    0,0,1,0,0,0,0,0,0,0,
    0,0,0,1,0,0,0,0,0,0,
    0,0,0,0,1,0,0,0,0,0,
    0,0,0,0,0,1,0,0,0,0,
    0,0,0,0,0,0,1,0,0,0,
    0,0,0,0,0,0,0,1,0,0,
    0,0,0,0,0,0,0,0,1,0,
    0,0,0,0,0,0,0,0,0,1,
    1,0,0,0,0,0,0,0,0,0,
    0,1,0,0,0,0,0,0,0,0,
    0,0,1,0,0,0,0,0,0,0,
    0,0,0,1,0,0,0,0,0,0,
    0,0,0,0,1,0,0,0,0,0,
    0,0,0,0,0,1,0,0,0,0,
    0,0,0,0,0,0,1,0,0,0,
    0,0,0,0,0,0,0,1,0,0,
    0,0,0,0,0,0,0,0,1,0,
    0,0,0,0,0,0,0,0,0,1,
    1,0,0,0,0,0,0,0,0,0,
    0,1,0,0,0,0,0,0,0,0,
    0,0,1,0,0,0,0,0,0,0,
    0,0,0,1,0,0,0,0,0,0,
    0,0,0,0,1,0,0,0,0,0,
    0,0,0,0,0,1,0,0,0,0,
    0,0,0,0,0,0,1,0,0,0,
    0,0,0,0,0,0,0,1,0,0,
    0,0,0,0,0,0,0,0,1,0,
    0,0,0,0,0,0,0,0,0,1,
    1,0,0,0,0,0,0,0,0,0,
    0,1,0,0,0,0,0,0,0,0,
    0,0,1,0,0,0,0,0,0,0,
    0,0,0,1,0,0,0,0,0,0,
    0,0,0,0,1,0,0,0,0,0,
    0,0,0,0,0,1,0,0,0,0,
    0,0,0,0,0,0,1,0,0,0,
    0,0,0,0,0,0,0,1,0,0,
    0,0,0,0,0,0,0,0,1,0,
    0,0,0,0,0,0,0,0,0,1,
    1,0,0,0,0,0,0,0,0,0,
    0,1,0,0,0,0,0,0,0,0,
    0,0,1,0,0,0,0,0,0,0,
    0,0,0,1,0,0,0,0,0,0,
    0,0,0,0,1,0,0,0,0,0,
    0,0,0,0,0,1,0,0,0,0,
    0,0,0,0,0,0,1,0,0,0,
    0,0,0,0,0,0,0,1,0,0,
    0,0,0,0,0,0,0,0,1,0,
    0,0,0,0,0,0,0,0,0,1,
    1,0,0,0,0,0,0,0,0,0,
    0,1,0,0,0,0,0,0,0,0,
    0,0,1,0,0,0,0,0,0,0,
    0,0,0,1,0,0,0,0,0,0,
    0,0,0,0,1,0,0,0,0,0,
    0,0,0,0,0,1,0,0,0,0,
    0,0,0,0,0,0,1,0,0,0,
    0,0,0,0,0,0,0,1,0,0,
    0,0,0,0,0,0,0,0,1,0,
    0,0,0,0,0,0,0,0,0,1,
    1,0,0,0,0,0,0,0,0,0,
    0,1,0,0,0,0,0,0,0,0,
    0,0,1,0,0,0,0,0,0,0,
    0,0,0,1,0,0,0,0,0,0,
    0,0,0,0,1,0,0,0,0,0,
    0,0,0,0,0,1,0,0,0,0,
    0,0,0,0,0,0,1,0,0,0,
    0,0,0,0,0,0,0,1,0,0,
    0,0,0,0,0,0,0,0,1,0,
    0,0,0,0,0,0,0,0,0,1,
    1,0,0,0,0,0,0,0,0,0,
    0,1,0,0,0,0,0,0,0,0,
    0,0,1,0,0,0,0,0,0,0,
    0,0,0,1,0,0,0,0,0,0,
    0,0,0,0,1,0,0,0,0,0,
    0,0,0,0,0,1,0,0,0,0,
    0,0,0,0,0,0,1,0,0,0,
    0,0,0,0,0,0,0,1,0,0,
    0,0,0,0,0,0,0,0,1,0,
    0,0,0,0,0,0,0,0,0,1,
    1,0,0,0,0,0,0,0,0,0,
    0,1,0,0,0,0,0,0,0,0,
    0,0,1,0,0,0,0,0,0,0,
    0,0,0,1,0,0,0,0,0,0,
    0,0,0,0,1,0,0,0,0,0,
    0,0,0,0,0,1,0,0,0,0,
    0,0,0,0,0,0,1,0,0,0,
    0,0,0,0,0,0,0,1,0,0,
    0,0,0,0,0,0,0,0,1,0,
    0,0,0,0,0,0,0,0,0,1,
    1,0,0,0,0,0,0,0,0,0,
    0,1,0,0,0,0,0,0,0,0,
    0,0,1,0,0,0,0,0,0,0,
    0,0,0,1,0,0,0,0,0,0,
    0,0,0,0,1,0,0,0,0,0,
    0,0,0,0,0,1,0,0,0,0,
    0,0,0,0,0,0,1,0,0,0,
    0,0,0,0,0,0,0,1,0,0,
    0,0,0,0,0,0,0,0,1,0,
    0,0,0,0,0,0,0,0,0,1,
   
};
//typedef struct
    
leds_frame leds[LEDS_NUM_TATAL]= 
{
    {
        .width=10,
        .length = 10,
        .time = 500,
        .buf = (unsigned char *)leds_buf_1,
    },
    {
    .width=10,
    .length = 10,
    .time = 500,
    .buf = (unsigned char *)leds_buf_2,
    },
    {
    .width=10,
    .length = 10,
    .time = 500,
    .buf = (unsigned char *)leds_buf_3,
    },
    {
    .width=10,
    .length = 10,
    .time = 500,
    .buf = (unsigned char *)leds_buf_4,
    },
    {
    .width=10,
    .length = 12,
    .time = 500,
    .buf = (unsigned char *)leds_buf_5,
    },
    {
    .width=10,
    .length = 12,
    .time = 500,
    .buf = (unsigned char *)leds_buf_6,
    },
    {
    .width=10,
    .length = 12,
    .time = 500,
    .buf = (unsigned char *)leds_buf_7,
    },
    {
    .width=10,
    .length = 12,
    .time = 500,
    .buf = (unsigned char *)leds_buf_8,
    },
    {
    .width=10,
    .length = 10,
    .time = 500,
    .buf = (unsigned char *)leds_buf_9,
    },
    {
    .width=10,
    .length = 10,
    .time = 500,
    .buf = (unsigned char *)leds_buf_10,
    },
                {
    .width=10,
    .length = 11,
    .time = 500,
    .buf = (unsigned char *)leds_buf_11,
    },
    {
    .width=10,
    .length = 11,
    .time = 500,
    .buf = (unsigned char *)leds_buf_12,
    },
    {
    .width=10,
    .length = 100,
    .time = 100,
    .buf = (unsigned char *)leds_buf_13,
    },
};


int led_set_dev(leds_frame led)
{
    
    unsigned char i;
    uint16_t ret;
    unsigned char val;
    
    OSTimeDly(10);
    val = get_random();
    
    for(i=0;i<led.length;i++)
    {
        ret = led.width*i;
        led_set_gpio(led.buf+ret,led.width);
        
        
        //OSTimeDly(led.time);
      
        OSTimeDly(val*10);
    }
   
    return 0;
}

void LedsTask(void *pd)
{ 
//    unsigned char i;
    unsigned char ret;
    
    leds_init();
    
    while(1)
	{
        OSTimeDly(10);
        ret = get_random();
        ret = ret%LEDS_NUM_TATAL;
        led_set_dev(leds[ret]);
        
//        for(i=0;i<LEDS_NUM_TATAL;i++)
//        {
//            led_set_dev(leds[i]);
//        }

	}
}

